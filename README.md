```plaintext
==============================================================================================================
######## ##       ########    ###    #### ########   #######   ######
##       ##       ##         ## ##    ##  ##     ## ##     ## ##    ## 
##       ##       ##        ##   ##   ##  ##     ## ##     ## ##                    电鳗AI检测套装
######   ##       ######   ##     ##  ##  ########  ##     ## ##       
##       ##       ##       #########  ##  ##        ##     ## ##          版权所有：北京模湖智能科技有限责任公司
##       ##       ##       ##     ##  ##  ##        ##     ## ##    ## 
######## ######## ######## ##     ## #### ##         #######   ######                                        
==============================================================================================================                                                              
```

# 🛡️ 电鳗AI检测套装

## 版本
**v1.0.0** | 发布日期：2025-07-08  
📦 [GitHub 仓库](https://github.com/honysyang/eleaipoc) | ✨ [更新日志](https://github.com/honysyang/eleaipoc/releases)


## 简介
电鳗 AI 检测套装是一款专注于 AI 框架的自动化安全检测工具集，深度聚焦 AI 框架特有的安全风险场景，可快速识别AI供应链漏洞的高危漏洞，提供针对性修复建议与安全加固方案。


### 🌟 核心特性
- **AI 框架原生适配**：基于 AI 框架底层通信协议（如 RPC/REST API）和内存管理机制，定制化检测逻辑，而非通用网络扫描
- **聚焦AI 供应链安全**：精准识别 AI供应链特有的漏洞类型，如模型删除、模型信息泄露、模型滥用等
- **自动化报告**：生成详细的HTML安全审计报告
- **灵活扫描模式**：支持单框架深度检测（如 llama.cpp 的 RPC 接口专项测试）和多框架全景扫描，贴合 AI 部署架构
- **AI 漏洞库动态更新**：紧跟 AI 框架安全动态，针对模型部署推理框架等核心组件的新漏洞快速响应


## 支持框架及 AI 专属漏洞
| 框架名称   | CVE列表          | 
|------------|-------------------|
| llama.cpp  | CVE-2024-42479、  CVE-2024-42478、CVE-2024-42477         |
| Vllm       | CVE_2024_9052 、 CVE_2025_47277、  CVE_2025_29783       |
| Ollama    | CNVD-2025-04094、CVE-2024-37032           |
| Ray        | CVE-2024-57000、CVE2023-48022           |
| Xinference | CVE-2025-45424           |
| Torchserve | CVE-2023-43654         |


## 环境要求
- **操作系统**：Windows 10/11、Linux (Ubuntu/Debian/CentOS)、macOS
- **Python**：3.12 或 Anaconda/Miniconda



## 文件结构
```plaintext
eleaipoc.py                                                          #主程序，用于运行漏洞扫描模块
install_scrip.sh                                                     #linux环境下自动安装脚本
install_script.ps1                                                   #windows环境下自动安装脚本
requirements.txt:                                                    #项目依赖文件
lib/                                                                 #漏洞扫描模块
```

## 🚀 使用方法

### 1. 克隆项目
```bash
git clone https://github.com/honysyang/eleaipoc.git
cd eleaipoc
```



### 2. 💻 安装环境
根据您的操作系统选择对应安装方式：

#### **Windows（管理员权限）**
```powershell
./install_script.ps1
```

#### **linux环境(建议root权限运行)**
```bash
chmod 777 install_script.sh
./install_script.sh
```
#### **手动安装**
```bash
# 创建虚拟环境
python -m venv venv
      
# 激活虚拟环境
# Linux/macOS:
source venv/bin/activate
# Windows:
venv\Scripts\activate
      
# 安装依赖
pip install -r requirements.txt
```

### 3. 🔍运行漏洞扫描模块
   
```bash
source venv/bin/activate 或 venv\Scripts\activate
python eleaipoc.py --poc llama.cpp --ip 127.0.0.1 --port 8000 --output output/
```

## 参数配置

| 参数                        | 描述                                                                 | 默认值         |
|-----------------------------|----------------------------------------------------------------------|----------------|
| `--poc`                     | 指定要运行的漏洞扫描模块<br>支持：llama.cpp、Ollama、Ray、Vllm、Xinference、Torchserve、all | -              |
| `--ip`                      | 指定目标 IP 地址                                                     | -              |
| `--port`                    | 指定目标端口                                                         | -              |
| `--output`                  | 指定输出目录                                                         | 当前目录       |


## 例子1：工具安装

```
(eleaipoc) root@uweic:/home/workspace/pysectool/eleaipoc# ./install_script.sh 
==============================================================================
   _____  _____      _____    ____    _____  _____    ____      ____  
  / ___/ (_   _)    / ___/   (    )  (_   _)(  __ \  / __ \    / ___) 
 ( (__     | |     ( (__     / /\ \    | |   ) )_) )/ /  \ \  / /     
  ) __)    | |      ) __)   ( (__) )   | |  (  ___/( ()  () )( (      
 ( (       | |   __( (       )    (    | |   ) )   ( ()  () )( (      
  \\ \_\_\ __| |___) \\) \_\_\___  /  /\  \  _| |__( (     \\ \_\__/ /  \\ \_\___  
   \\____\________/  \\____\/__(  )__\/_____(/__\     \\____/    \\____) 
                                                                                 
 ============================= 电鳗AI检测套装 ================================== 
                     版权所有：北京模湖智能科技有限责任公司                         
 ==============================================================================
2025-07-08 18:49:09 - INFO: 开始安装流程
2025-07-08 18:49:09 - INFO: 详细日志保存在install.log文件中
2025-07-08 18:49:09 - WARNING: 脚本以root用户运行，请注意潜在的安全风险
2025-07-08 18:49:09 - INFO: 未检测到 conda，使用 python 创建虚拟环境
2025-07-08 18:49:09 - INFO: Python 版本检查通过，版本为 3.12
2025-07-08 18:49:09 - INFO: 正在创建 Python 虚拟环境...
2025-07-08 18:49:12 - SUCCESS: 创建 Python 虚拟环境 执行成功
2025-07-08 18:49:12 - INFO: 正在安装依赖包，这可能需要几分钟时间...
2025-07-08 18:49:12 - INFO: 安装中，请耐心等待...
[################################################## ] 100%
2025-07-08 18:52:37 - SUCCESS: 安装依赖包 执行成功
2025-07-08 18:52:37 - INFO: 验证安装...
2025-07-08 18:52:37 - SUCCESS: 验证 Python 环境 执行成功

=====================================================================
                      安装流程已成功完成                            
=====================================================================

使用说明:
  1. 激活虚拟环境:
     conda activate venv

  2. 运行检测工具 (示例):
     python3 eleaipoc.py --poc llama.cpp --ip 127.0.0.1 --port 8000 --output output/

更多选项请查看帮助:
     python3 eleaipoc.py --help

日志文件位置: /home/workspace/pysectool/eleaipoc/install.log
=====================================================================
2025-07-08 18:52:37 - SUCCESS: 安装脚本正常退出

```


## 例子2:检测目标框架

```
python eleaipoc.py --poc llama.cpp --ip 127.0.0.1 --port 8000 --output output/
```
```
(eleaipoc) root@uweic:/home/workspace/pysectool/eleaipoc# python eleaipoc.py --poc ray  --ip 127.0.0.1 --port 8265
```

```

================================================================================
  _____  _____      _____    ____    _____  _____    ____      ____  
 / ___/ (_   _)    / ___/   (    )  (_   _)(  __ \  / __ \    / ___) 
( (__     | |     ( (__     / /\ \    | |   ) )_) )/ /  \ \  / /     
 ) __)    | |      ) __)   ( (__) )   | |  (  ___/( ()  () )( (      
( (       | |   __( (       )    (    | |   ) )   ( ()  () )( (      
 \ \___ __| |___) )\ \_\___  /  /\  \  _| |__( (     \ \_\__/ /  \ \___  
  \____\________/  \____\/__(  )__\/_____(/__\     \____/    \____) 
                                                                                
============================= 电鳗AI检测套装 =====================================
                    版权所有：北京模湖智能科技有限责任公司                          
================================================================================
2025-07-05 00:00:17,630 INFO dashboard_sdk.py:338 -- Uploading package gcs://_ray_pkg_bfc22502c84e31b5.zip.
2025-07-05 00:00:17,630 INFO packaging.py:588 -- Creating a file package for local module './'.
Submitted job ID: raysubmit_LUPspvi8ekxhfU8X
**** 创建job(检测用例)成功，获得job_id为raysubmit_LUPspvi8ekxhfU8X。

检测结果:发现当前Ray框架存在漏洞风险
结果已保存到指定文件: output/ray_20250705000017.html
```
查看检测结果文件：https://github.com/honysyang/eleaipoc/blob/main/output/all_20250708152652.html

![image](https://github.com/user-attachments/assets/daca348a-3248-437e-9436-5db18061ebf0)


## 技术交流
扫描下方二维码，可参与技术讨论、AI创新

<img src="https://github.com/user-attachments/assets/f2703a12-bbff-47ef-8105-89ad0383882a" width="400" alt="image">
<img src="https://github.com/user-attachments/assets/2749b7bb-5825-459d-be38-8d45005fb4be" width="400" alt="模湖公众号">




## 声明

本工具为AI框架漏洞检测工具的自查版本，仅用于本地测试和安全评估，不得用于非法或未授权的用途。
此外，我们还具备攻击版本，可用于攻击测试，若用户存在其他需求，可联系我们


